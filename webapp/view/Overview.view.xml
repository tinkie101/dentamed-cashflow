<mvc:View
	controllerName="dentamed.cashflow.controller.Overview"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:f="sap.f"
	xmlns:l="sap.ui.layout"
	xmlns="sap.m"
	busy="{viewModel>/busy}"
	busyIndicatorDelay="{viewModel>/delay}">
	<Page showHeader="false">
		<f:DynamicPage headerExpanded="true"
					   preserveHeaderStateOnScroll="true"
					   toggleHeaderOnTitleClick="false">
			<f:title>
				<f:DynamicPageTitle>
					<f:heading>
						<Title text="{i18n>appTitle}"/>
					</f:heading>
					<f:actions>
						<Button icon="sap-icon://print"
								text="{i18n>print}"
								type="Transparent"
								press="onPrintPressed"
								enabled="{= !${viewModel>/editable} }"/>
					</f:actions>
				</f:DynamicPageTitle>
			</f:title>
			<f:content>
				<FlexBox height="98%">
					<Table busyIndicatorDelay="{viewModel>/delay}"
						   busy="{viewModel>/busy}"
						   items="{viewModel>/items}"
						   class="sapUiSizeCompact">
						<headerToolbar>
							<Toolbar>
								<ToolbarSpacer/>
								<Button text="{i18n>edit}"
										press="onEditPressed(${viewModel>/editable})"
										visible="{= !${viewModel>/editable} }"/>
								<Button text="{i18n>add}"
										press="onAddPressed"
										visible="{viewModel>/editable}"/>
								<Button text="{i18n>save}"
										type="Transparent"
										press="onEditPressed(${viewModel>/editable})"
										visible="{viewModel>/editable}"/>
								<Button text="{i18n>cancel}"
										type="Transparent"
										press="onEditPressed(${viewModel>/editable})"
										visible="{viewModel>/editable}"/>
							</Toolbar>
						</headerToolbar>
						<infoToolbar>
							<Toolbar>
								<l:Grid vSpacing="0"
										hSpacing="0">
									<HBox alignItems="Center">
										<layoutData>
											<l:GridData span="XL11 L11 M11 S11"/>
										</layoutData>
										<Label text="{i18n>dateRange}:"/>
										<DatePicker displayFormat="MMMM yyyy"
													value="{viewModel>/selectedDate}"
													valueFormat="MM-yyyy"
													change="onDateChange(${viewModel>/selectedDate})"
													class="sapUiSmallMarginBegin"
													editable="{= !${viewModel>/editable} }">
										</DatePicker>
									</HBox>
								</l:Grid>
								<ToolbarSpacer/>
								<ObjectStatus text="{i18n>income}:"
											  state="Success"/>
								<Text text="{parts: [{path: 'viewModel>/items'}, {path: 'viewModel>/income'}], formatter: '.calculateTotal'}"/>

								<ObjectStatus text="{i18n>expenses}:"
											  state="Error"/>
								<Text text="{parts: [{path: 'viewModel>/items'}, {path: 'viewModel>/expense'}], formatter: '.calculateTotal'}"/>

								<ObjectStatus text="{i18n>net}:"
											  state="Success"/>
								<Text text="{parts: [{path: 'viewModel>/items'},  {path: 'viewModel>/net'}], formatter: '.calculateTotal'}"/>
							</Toolbar>
						</infoToolbar>
						<columns>
							<Column hAlign="Center"
									width="22%">
								<Text text="{i18n>date}"/>
							</Column>
							<Column hAlign="Center"
									width="5rem">
								<Text text="{i18n>valType}"/>
							</Column>
							<Column width="10rem">
								<Text text="{i18n>value}" class="sapUiTinyMarginBegin"/>
							</Column>
							<Column>
								<Text text="{i18n>comment}"/>
							</Column>
							<Column hAlign="Center"
									width="3rem">
							</Column>
						</columns>
						<items>
							<ColumnListItem>
								<cells>
									<DatePicker editable="{viewModel>/editable}"
												displayFormat="dd MMMM"
												valueFormat="dd-MM-yyyy"
												value="{viewModel>date}"
												textAlign="Center"
												minDate="{viewModel>/minDate}"
												maxDate="{viewModel>/maxDate}"/>
									<VBox justifyContent="Center">
										<Button text="{= ${viewModel>income}? 'Income': 'Expense'}"
												type="{= ${viewModel>income}? 'Accept': 'Reject' }"
												press="onToggleType"
												visible="{viewModel>/editable}"/>
										<ObjectStatus text="{= ${viewModel>income}? 'Income': 'Expense'}"
													  state="{= ${viewModel>income}? 'Success': 'Error' }"
													  visible="{= !${viewModel>/editable} }"/>
									</VBox>

									<VBox class="sapUiTinyMarginBegin">
										<ObjectStatus text="{
														path: 'viewModel>value',
														formatter: '.formatCurrency'
													  }"
													  state="{= ${viewModel>income}? 'Success': 'Error' }"
													  visible="{= !${viewModel>/editable} }"/>

										<Input visible="{viewModel>/editable}"
											   type="Number"
											   value="{viewModel>value}"/>
									</VBox>

									<VBox>
										<Text text="{viewModel>comment}"
											  visible="{= !${viewModel>/editable} }"/>
										<Input visible="{viewModel>/editable}"
											   value="{viewModel>comment}"/>
									</VBox>

									<Button icon="sap-icon://delete"
											type="Reject"
											visible="{viewModel>/editable}"/>
								</cells>
							</ColumnListItem>
						</items>
					</Table>
				</FlexBox>
			</f:content>
		</f:DynamicPage>
	</Page>
</mvc:View>
